# Maven

## Installing Maven on Mac OS X

After downloading Maven 3.0.3 from [http://maven.apache.org/download.html](http://maven.apache.org/download.html)

    $ tar -zxvf apache-maven-3.0.3.tar.gz
    $ mv apache-maven-3.0.3 /Users/brian/Applications/

Then edit `~/.profile` and add the following:
    
    export JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
    export M2_HOME=/Users/brian/Applications/apache-maven-3.0.3
    export PATH=$PATH:$M2_HOME/bin

Once you're done editing you can run the following command to immediately execute your profile updates:

    $ source ~/.profile

## Creating Maven Projects

### Create a Maven Project Using Archetypes Interactively

	$ mvn archetype:generate

### Create a Maven Project Using Archetypes Non-interactively

	$ mvn archetype:generate -DgroupId=com.example -DartifactId=hello -Dversion=1.0-SNAPSHOT -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false

## Use a Hosted Repository as a Mirror

Edit `~/.m2/settings.xml` and add the following:

	<settings>
		<!-- other stuff -->
		<mirrors>
			<mirror>
				<id>archiva</id>
				<name>Archiva</name>
				<url>http://localhost/archiva/</url>
				<mirrorOf>*</mirrorOf>
			</mirror>
		</mirrors>
	</settings>

## Installing a non-Mavenized Artifact 

Sometimes your project will depend on a library that isn't a Maven artifact itself. In those cases you'll need to install it to your local repository or a hosted repository.

### Install an Artifact to your Local Repository

    $ mvn install:install-file -Dfile=outsider.jar - DgroupId=com.badexample -DartifactId=outsider -Dversion=1 -Dpackaging=jar -DgeneratePom=true

### Deploy a Dependency to your a Hosted Repository

	$ mvn deploy:deploy-file -DgroupId=com.example -DartifactId=hello -Dversion=1.0.0 -DgeneratePom=true -Dpackaging=jar -Dfile=hello-1.0.0.jar -Durl=???

## Deploy Your Project to a Hosted Repository

If you're hosting your own Maven Repository you'll likely want to be able to deploy your own projects to it.

### Add your Host Repository to your Project

First you need to add you hosted repositories to your project's `pom.xml`:

	<project>
		<!-- other stuff -->
		<distributionManagement>
			<repository>
				<id>internal</id>
				<url>http://maven.example.com/archiva/repository/internal/</url>
			</repository>
			<snapshotRepository>
				<id>snapshots</id>
				<url>https://maven.example.com/archiva/repository/snapshots/</url>
			</snapshotRepository>
		</distributionManagement>
	</project>
	
### Provide Authentication for Server

Edit your `~/.m2/settings.xml` and add the following:

	<settings>
		<!-- other stuff -->
		<servers>
			<server>
				<id>internal</id>
				<username>username</username>
				<password>password</password>
			</server>
			<server>
				<id>snapshots</id>
				<username>username</username>
				<password>password</password>
			</server>
		</servers>
	</settings>
	
Now you can run:

	$ mvn deploy

## Snapshot vs. Release

### Snapshot

Artifacts generated by projects that are actively being developed are considered Snapshots. If your project depends on other artifacts that are Snapshots, it will try to resolve the latest version of that artifact.

If the `version` property contains the string `SNAPSHOT`, Maven will replace this with a date/timestamp when you `install` or `depoy` the artifact.

### Release

> When releasing a project, you should resolve all dependencies on SNAPSHOT versions to dependencies on released versions.

## Resources

* [Maven: The Complete Reference](http://sonatype.com/books/mvnref-book/reference/public-book.html)
* [Maven by Example](http://www.sonatype.com/books/mvnex-book/reference/public-book.html)
* [Developing with Eclipse and Maven](http://www.sonatype.com/books/m2eclipse-book/reference/)
* [Repository Management with Nexus](http://www.sonatype.com/books/nexus-book/reference/)
